<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>- Jamie Gunner</title><meta name=Description content="Website for Jamie Gunner."><meta property="og:title" content><meta property="og:description" content="On a recent CTF that I competed in, me and my team had worked together on an incredibly tough Misc challenge. Considering that this was the first of many challenges, it was quite an arduous task. After attempting to complete this, my team and I had realised that we may not have trained enough for this CTF challenge. Despite this, I wanted to give a small write up detailing what we managed to accomplish as this was a considerably enjoyable challenge."><meta property="og:type" content="article"><meta property="og:url" content="https://swiftlaggy.github.io/blog/misc/misc/"><meta property="og:image" content="https://swiftlaggy.github.io/images/sw.svg"><meta property="article:section" content="blog"><meta property="article:modified_time" content="2023-10-16T23:25:09+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://swiftlaggy.github.io/images/sw.svg"><meta name=twitter:title content><meta name=twitter:description content="On a recent CTF that I competed in, me and my team had worked together on an incredibly tough Misc challenge. Considering that this was the first of many challenges, it was quite an arduous task. After attempting to complete this, my team and I had realised that we may not have trained enough for this CTF challenge. Despite this, I wanted to give a small write up detailing what we managed to accomplish as this was a considerably enjoyable challenge."><meta name=application-name content="Jamie Gunner"><meta name=apple-mobile-web-app-title content="Jamie Gunner"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=canonical href=https://swiftlaggy.github.io/blog/misc/misc/><link rel=next href=https://swiftlaggy.github.io/blog/demo/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/swiftlaggy.github.io\/blog\/misc\/misc\/"},"image":["https:\/\/swiftlaggy.github.io\/images\/sw.jpeg"],"genre":"blog","wordcount":967,"url":"https:\/\/swiftlaggy.github.io\/blog\/misc\/misc\/","dateModified":"2023-10-16T23:25:09+01:00","publisher":{"@type":"Organization","name":"Jamie Gunner","logo":"https:\/\/swiftlaggy.github.io\/images\/sw.jpeg"},"author":{"@type":"Person","name":"Author"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Jamie Gunner">Jamie Gunner</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/>Home </a><a class=menu-item href=/about/>About </a><a class=menu-item href=/blog/>Blog </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Jamie Gunner">Jamie Gunner</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/ title>Home</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/blog/ title>Blog</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class="page single special"><h1 class="single-title animated pulse faster"></h1><div class=content id=content><p>On a recent CTF that I competed in, me and my team had worked together on an incredibly tough Misc challenge. Considering that this was the first of many challenges, it was quite an arduous task.
After attempting to complete this, my team and I had realised that we may not have trained enough for this CTF challenge. Despite this, I wanted to give a small write up detailing what we managed to accomplish as this was a considerably enjoyable challenge.</p><h1 id=the-email>The Email</h1><p>Within the challenge .ZIP folder contained a singular .TXT email file.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/Email.jpg data-srcset="../images/Email.jpg, ../images/Email.jpg 1.5x, ../images/Email.jpg 2x" data-sizes=auto alt=../images/Email.jpg title="Picture 1"></p><p>We can see in this email that it covers many areas. The first email holds a lot of information, starting with Jenny&rsquo;s &ldquo;<a href=mailto:jfeng@veryrealmail.com rel>jfeng@veryrealmail.com</a>&rdquo;. Then, we have her personal information:</p><ul><li>Date of Birth: 02/08/1990</li><li>Postal Code: 00100</li><li>Weight: 61kg</li></ul><p>Next, we can see the email provides us with a .ZIP but it is password protected. The problem that we are faced with, is that we have not been provided this password as it was in their previous emails.</p><p>We are also provided with another attachment, which appears to be a receipt, asking us to make sure the (m)data is correct, assuming this could be meta data, maybe steganography. The main problem currently, is that we do not have access to either attachment, but it does provide us with 2 Base64 strings.</p><p>One of which is far too long to input on this website however, I can paste the other.</p><h1 id=the-first-base64>The First Base64</h1><p><code>UEsDBDMAAQBjABt3Q1cAAAAAPwAAACMAAAAIAAsAZmxhZy50eHQBmQcAAgBBRQMAALXlHmkDJrqpuC6UsKfMRf0ryv1ot/Vf0o0rJl7iNPv+pINt/HGY9cx7/J7HpS5xfce96yETu2enDZD+8nLU31BLAQI/ADMAAQBjABt3Q1cAAAAAPwAAACMAAAAIAC8AAAAAAAAAIAAAAAAAAABmbGFnLnR4dAoAIAAAAAAAAQAYANdGZhT59dkBWFt5Lfn12QFO9TAOV8XZAQGZBwACAEFFAwAAUEsFBgAAAAABAAEAZQAAAHAAAAAAAA==</code></p><p>Once this is put into Cyberchef, we are given a very odd string:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/CyberFail.jpg data-srcset="../images/CyberFail.jpg, ../images/CyberFail.jpg 1.5x, ../images/CyberFail.jpg 2x" data-sizes=auto alt=../images/CyberFail.jpg title="Picture 2"></p><p>But the email states it is Base64 encoding. I then noticed that it is a .ZIP as previously stated. So, I did some research and found Base64 to file from Base64 guru.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/B642F.jpg data-srcset="../images/B642F.jpg, ../images/B642F.jpg 1.5x, ../images/B642F.jpg 2x" data-sizes=auto alt=../images/B642F.jpg title="Picture 3"></p><p>This website gave us Application.zip containing a .TXT file however, it seems to be password protected with no password in sight.</p><p>![Picture 4](../images/Passworded file.jpg)</p><p>There must be a password. I continued on as I would normally, with the information that there was a password given previously. Maybe it could be elsewhere, perhaps the metadata of the .PNG of the next Base64 encoding. As expected, Cyberchef could not decode it as it is an image however, one must test these things.</p><h1 id=the-second-base64>The Second Base64</h1><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/Base64Fail2.jpg data-srcset="../images/Base64Fail2.jpg, ../images/Base64Fail2.jpg 1.5x, ../images/Base64Fail2.jpg 2x" data-sizes=auto alt=../images/Base64Fail2.jpg title="Picture 5"></p><p>As cyberchef had an issue, I had to find another alternative. As we were loading an image from Base64, it was only natural to go for a Base64 to image. So I found a website with such services and it returned:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/B64toImage.jpg data-srcset="../images/B64toImage.jpg, ../images/B64toImage.jpg 1.5x, ../images/B64toImage.jpg 2x" data-sizes=auto alt=../images/B64toImage.jpg title="Picture 6"></p><h1 id=stenography>Stenography</h1><p>We were told &ldquo;(m)data&rdquo;; I believe this to be the meta data. So, I loaded up my Kali Linux machine with a stenography tool and looked at the meta data. I could use basic websites, but I prefer to perfect the skills with tools rather than use websites. I decided to use an easy tool, as I was only searching the meta data.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/Exif.jpg data-srcset="../images/Exif.jpg, ../images/Exif.jpg 1.5x, ../images/Exif.jpg 2x" data-sizes=auto alt=../images/Exif.jpg title="Picture 7"></p><p>As explained in the Copyright field, there is a password format, &ldquo;birthDateMail***R3ply!&rdquo;. It was specified by the creators. The asterixis&rsquo; are random characters/symbols, which means we have a base password format with 3 random characters. We have all the information and this would be: ```</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>900802jfeng@veryrealmail.com***R3ply! 
</span></span></code></pre></td></tr></table></div></div><p>But what are the three characters? I had to write a script on Python in order to cover every possible combination.</p><h1 id=python-program>Python Program</h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>import itertools
</span></span><span class=line><span class=cl>import string
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>email_address = &#34;900802jfeng@veryrealmail.com***R3ply!&#34;
</span></span><span class=line><span class=cl>characters = string.ascii_letters + string.digits + &#34;!@#$%^&amp;*()-_=+[]{}|;:&#39;\&#34;,.&lt;&gt;?/\\~`&#34;  # Alphabets, numbers, and special characters
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Find asterisk positions
</span></span><span class=line><span class=cl>asterisk_positions = [pos for pos, char in enumerate(email_address) if char == &#34;*&#34;]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Generate combinations of single characters
</span></span><span class=line><span class=cl>combinations = itertools.product(characters, repeat=len(asterisk_positions))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>#output file name
</span></span><span class=line><span class=cl>output_file = &#34;email_combinations.txt&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Open the file for writing
</span></span><span class=line><span class=cl>with open(output_file, &#34;w&#34;) as file:
</span></span><span class=line><span class=cl>    # Iterate through the combinations
</span></span><span class=line><span class=cl>    for combination in combinations:
</span></span><span class=line><span class=cl>        modified_email = list(email_address)
</span></span><span class=line><span class=cl>        for i, char in zip(asterisk_positions, combination):
</span></span><span class=line><span class=cl>            modified_email[i] = char
</span></span><span class=line><span class=cl>        modified_email = &#34;&#34;.join(modified_email)
</span></span><span class=line><span class=cl>        file.write(modified_email + &#34;\n&#34;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>print(f&#34;Email combinations with numbers and special characters have been saved to {output_file}&#34;)
</span></span></code></pre></td></tr></table></div></div><p>This created a massive file of roughly 830584 lines. Once I ran this through JohnTheRipper, we got the answer. But to run it through John, I needed to perform other actions. So I remain on Kali, as this would possess the tools needed to continue, Starting with Zip2John. This takes all hashes that needed to be cracked, and turns them into a file in order for John to work his magic and crack the password using a word list.</p><h1 id=johntheripper>JohnTheRipper</h1><p>![Picture 8](../images/Zip hashes.jpg)</p><p>Then, once I had retrieved the &ldquo;zip.hashes&rdquo; file, I ran John with the word list created earlier and obtained:</p><p>![Picture 9](../images/John password.jpg)</p><p>Once I obtained the password, I unfortunately had to move to ParrotOS as John had noticed I had run this command before and obtained the password. So I figured I&rsquo;d go to Parrot to finish the job for a 2nd time. But huzzah! We have the password. Let&rsquo;s open the flag.txt file.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/Flag.jpg data-srcset="../images/Flag.jpg, ../images/Flag.jpg 1.5x, ../images/Flag.jpg 2x" data-sizes=auto alt=../images/Flag.jpg title="Picture 10"></p><p>We have now obtained a flag, brilliant! 100 points to us in the CTF. Unfortunately, we did not continue this event, on the basis that it was quite late and slightly beyond our own capabilities but, that is why we do them, to see where we need to sharpen our skills.</p><h1 id=conclusion>Conclusion</h1><p>I sincerely hope that you have been able to gain some knowledge from this write up. I can say with certainty that I have.
This has given me the opportunity to improve and hone my Python skills, alongside gaining the knowledge that applications can be encoded and decoded as Base64. This means that other applications can be encoded with different encoding techniques (something to learn later on).
Participation in this CTF has also allowed me to gain additional experience with JohnTheRipper.</p></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>